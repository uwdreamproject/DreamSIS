<h3 class="pre-title"><%= link_to h(@participant.fullname), @participant %></h3>
<h1>College Enrollments</h1>

<table id="college_enrollments" class="multirow">
	<thead>
		<tr>
			<th>College</th>
			<th>Status</th>
			<th>Class</th>
			<th>Major(s)</th>
			<th>Start</th>
			<th>End</th>
			<th>Source</th>
			<th colspan=3>Functions</th>
		</tr>
	</thead>

	<%- if @college_enrollments.empty? -%>
	
		<tbody>
			<tr class="empty">
				<td colspan="10">No college enrollments yet.</td>
			</tr>
		</tbody>
		
	<% else %>

		<%- 
		es = { :enrollments => {}, :previous => nil, :index => 0 }
		for e in @college_enrollments 
			es[:index] += 1 if e.institution_id != es[:previous]
			es[:enrollments][es[:index]] ||= []
			es[:enrollments][es[:index]] << e
			es[:previous] = e.institution_id
		end
		
		for index, enrollments in es[:enrollments] -%>
			<tbody>
				<%- enrollments.each_with_index do |enrollment, index| -%>
					<%= render :partial => "college_enrollments/college_enrollment", 
								:object => enrollment, 
								:locals => { :rowspan => enrollments.size, :hide_title_cell => (true if index > 0) } %>
				<% end %>
			</tbody>
		<% end %>
	<% end %>


</table>	


<div id="sidebar">
	<%= link_to 'Add college enrollment', new_participant_college_enrollment_path, :class => 'add button' %>
</div>
